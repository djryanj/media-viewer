<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A self-hosted media gallery for your private media collection."><meta name=author content="Ryan Jacobs"><link href=https://djryanj.github.io/media-viewer/development/monitoring/ rel=canonical><link href=../architecture/ rel=prev><link href=../testing/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.2"><title>Monitoring Stack - Media Viewer Documentation</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=slate data-md-color-primary=pink data-md-color-accent=pink> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#development-monitoring-stack class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Media Viewer Documentation" class="md-header__button md-logo" aria-label="Media Viewer Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 16V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-11-4 2.03 2.71L16 11l4 5H8M2 6v14a2 2 0 0 0 2 2h14v-2H4V6"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Media Viewer Documentation </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Monitoring Stack </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=pink data-md-color-accent=pink aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=pink data-md-color-accent=pink aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/djryanj/media-viewer title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ghcr.io/djryanj/media-viewer </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../getting-started/installation/ class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../faq/ class=md-tabs__link> FAQ </a> </li> <li class=md-tabs__item> <a href=../../user-guide/overview/ class=md-tabs__link> User Guide </a> </li> <li class=md-tabs__item> <a href=../../features/pwa/ class=md-tabs__link> Features </a> </li> <li class=md-tabs__item> <a href=../../admin/overview/ class=md-tabs__link> Administration </a> </li> <li class=md-tabs__item> <a href=../../api/overview/ class=md-tabs__link> API Reference </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../architecture/ class=md-tabs__link> Development </a> </li> <li class=md-tabs__item> <a href=../../troubleshooting/ class=md-tabs__link> Troubleshooting </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Media Viewer Documentation" class="md-nav__button md-logo" aria-label="Media Viewer Documentation" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M22 16V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-11-4 2.03 2.71L16 11l4 5H8M2 6v14a2 2 0 0 0 2 2h14v-2H4V6"/></svg> </a> Media Viewer Documentation </label> <div class=md-nav__source> <a href=https://github.com/djryanj/media-viewer title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> ghcr.io/djryanj/media-viewer </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installation/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/quick-start/ class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/configuration/ class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> User Guide </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../user-guide/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/browsing/ class=md-nav__link> <span class=md-ellipsis> Browsing Media </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/search/ class=md-nav__link> <span class=md-ellipsis> Search </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/tagging/ class=md-nav__link> <span class=md-ellipsis> Tagging </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/favorites/ class=md-nav__link> <span class=md-ellipsis> Favorites </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/playlists/ class=md-nav__link> <span class=md-ellipsis> Playlists </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/webauthn/ class=md-nav__link> <span class=md-ellipsis> WebAuthn/Passkeys </span> </a> </li> <li class=md-nav__item> <a href=../../user-guide/keyboard-shortcuts/ class=md-nav__link> <span class=md-ellipsis> Keyboard Shortcuts </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Features </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Features </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../features/pwa/ class=md-nav__link> <span class=md-ellipsis> PWA Support </span> </a> </li> <li class=md-nav__item> <a href=../../features/tag-management/ class=md-nav__link> <span class=md-ellipsis> Tag Management </span> </a> </li> <li class=md-nav__item> <a href=../../features/selection-mode/ class=md-nav__link> <span class=md-ellipsis> Selection Mode </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Administration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../admin/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../admin/server-config/ class=md-nav__link> <span class=md-ellipsis> Server Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../admin/environment-variables/ class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> <li class=md-nav__item> <a href=../../admin/webauthn/ class=md-nav__link> <span class=md-ellipsis> WebAuthn Setup </span> </a> </li> <li class=md-nav__item> <a href=../../admin/thumbnails/ class=md-nav__link> <span class=md-ellipsis> Thumbnail Management </span> </a> </li> <li class=md-nav__item> <a href=../../admin/metrics/ class=md-nav__link> <span class=md-ellipsis> Metrics & Monitoring </span> </a> </li> <li class=md-nav__item> <a href=../../admin/memory-tuning/ class=md-nav__link> <span class=md-ellipsis> Memory & GC Tuning </span> </a> </li> <li class=md-nav__item> <a href=../../admin/security/ class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_7> <label class=md-nav__link for=__nav_7 id=__nav_7_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../api/overview/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../api/authentication/ class=md-nav__link> <span class=md-ellipsis> Authentication </span> </a> </li> <li class=md-nav__item> <a href=../../api/webauthn/ class=md-nav__link> <span class=md-ellipsis> WebAuthn API </span> </a> </li> <li class=md-nav__item> <a href=../../api/files/ class=md-nav__link> <span class=md-ellipsis> Files & Media </span> </a> </li> <li class=md-nav__item> <a href=../../api/search/ class=md-nav__link> <span class=md-ellipsis> Search </span> </a> </li> <li class=md-nav__item> <a href=../../api/tags/ class=md-nav__link> <span class=md-ellipsis> Tags </span> </a> </li> <li class=md-nav__item> <a href=../../api/favorites/ class=md-nav__link> <span class=md-ellipsis> Favorites </span> </a> </li> <li class=md-nav__item> <a href=../../api/tags-favorites/ class=md-nav__link> <span class=md-ellipsis> Tags & Favorites </span> </a> </li> <li class=md-nav__item> <a href=../../api/system/ class=md-nav__link> <span class=md-ellipsis> System </span> </a> </li> <li class=md-nav__item> <a href=../../api/openapi/ class=md-nav__link> <span class=md-ellipsis> OpenAPI Spec </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8 checked> <label class=md-nav__link for=__nav_8 id=__nav_8_label tabindex> <span class=md-ellipsis> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=true> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> Development </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Monitoring Stack </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Monitoring Stack </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> <nav class=md-nav aria-label="Quick Start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-configure-media-directory class=md-nav__link> <span class=md-ellipsis> 1. Configure Media Directory </span> </a> </li> <li class=md-nav__item> <a href=#2-start-the-stack class=md-nav__link> <span class=md-ellipsis> 2. Start the Stack </span> </a> </li> <li class=md-nav__item> <a href=#3-access-services class=md-nav__link> <span class=md-ellipsis> 3. Access Services </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#helper-scripts class=md-nav__link> <span class=md-ellipsis> Helper Scripts </span> </a> <nav class=md-nav aria-label="Helper Scripts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#start-monitoring-stack class=md-nav__link> <span class=md-ellipsis> Start Monitoring Stack </span> </a> </li> <li class=md-nav__item> <a href=#generate-load class=md-nav__link> <span class=md-ellipsis> Generate Load </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-testing-workflow class=md-nav__link> <span class=md-ellipsis> Performance Testing Workflow </span> </a> <nav class=md-nav aria-label="Performance Testing Workflow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-establish-baseline class=md-nav__link> <span class=md-ellipsis> 1. Establish Baseline </span> </a> </li> <li class=md-nav__item> <a href=#2-run-load-tests class=md-nav__link> <span class=md-ellipsis> 2. Run Load Tests </span> </a> </li> <li class=md-nav__item> <a href=#3-test-configuration-changes class=md-nav__link> <span class=md-ellipsis> 3. Test Configuration Changes </span> </a> </li> <li class=md-nav__item> <a href=#4-compare-results class=md-nav__link> <span class=md-ellipsis> 4. Compare Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-metrics-to-monitor class=md-nav__link> <span class=md-ellipsis> Key Metrics to Monitor </span> </a> <nav class=md-nav aria-label="Key Metrics to Monitor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gc-performance class=md-nav__link> <span class=md-ellipsis> GC Performance </span> </a> </li> <li class=md-nav__item> <a href=#memory-metrics class=md-nav__link> <span class=md-ellipsis> Memory Metrics </span> </a> </li> <li class=md-nav__item> <a href=#application-performance class=md-nav__link> <span class=md-ellipsis> Application Performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prometheus-queries class=md-nav__link> <span class=md-ellipsis> Prometheus Queries </span> </a> <nav class=md-nav aria-label="Prometheus Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gc-performance_1 class=md-nav__link> <span class=md-ellipsis> GC Performance </span> </a> </li> <li class=md-nav__item> <a href=#application-performance_1 class=md-nav__link> <span class=md-ellipsis> Application Performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#grafana-dashboard class=md-nav__link> <span class=md-ellipsis> Grafana Dashboard </span> </a> <nav class=md-nav aria-label="Grafana Dashboard"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manual-import class=md-nav__link> <span class=md-ellipsis> Manual Import </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration-testing class=md-nav__link> <span class=md-ellipsis> Configuration Testing </span> </a> <nav class=md-nav aria-label="Configuration Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-configuration class=md-nav__link> <span class=md-ellipsis> Default Configuration </span> </a> </li> <li class=md-nav__item> <a href=#testing-gogc class=md-nav__link> <span class=md-ellipsis> Testing GOGC </span> </a> </li> <li class=md-nav__item> <a href=#testing-different-memory_ratio-values class=md-nav__link> <span class=md-ellipsis> Testing Different MEMORY_RATIO Values </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cannot-access-services class=md-nav__link> <span class=md-ellipsis> Cannot Access Services </span> </a> </li> <li class=md-nav__item> <a href=#no-metrics-showing-in-grafana class=md-nav__link> <span class=md-ellipsis> No Metrics Showing in Grafana </span> </a> </li> <li class=md-nav__item> <a href=#container-wont-start class=md-nav__link> <span class=md-ellipsis> Container Won't Start </span> </a> </li> <li class=md-nav__item> <a href=#media-directory-mount-error class=md-nav__link> <span class=md-ellipsis> Media Directory Mount Error </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benchmark-results class=md-nav__link> <span class=md-ellipsis> Benchmark Results </span> </a> <nav class=md-nav aria-label="Benchmark Results"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#before-optimization-manual-gc class=md-nav__link> <span class=md-ellipsis> Before Optimization (Manual GC) </span> </a> </li> <li class=md-nav__item> <a href=#after-optimization-memory_ratio075 class=md-nav__link> <span class=md-ellipsis> After Optimization (MEMORY_RATIO=0.75) </span> </a> </li> <li class=md-nav__item> <a href=#configuration-comparison class=md-nav__link> <span class=md-ellipsis> Configuration Comparison </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-persistence class=md-nav__link> <span class=md-ellipsis> Data Persistence </span> </a> </li> <li class=md-nav__item> <a href=#production-notes class=md-nav__link> <span class=md-ellipsis> Production Notes </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../testing/ class=md-nav__link> <span class=md-ellipsis> Testing </span> </a> </li> <li class=md-nav__item> <a href=../sample-media/ class=md-nav__link> <span class=md-ellipsis> Sample Media </span> </a> </li> <li class=md-nav__item> <a href=../contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../troubleshooting/ class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#quick-start class=md-nav__link> <span class=md-ellipsis> Quick Start </span> </a> <nav class=md-nav aria-label="Quick Start"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-configure-media-directory class=md-nav__link> <span class=md-ellipsis> 1. Configure Media Directory </span> </a> </li> <li class=md-nav__item> <a href=#2-start-the-stack class=md-nav__link> <span class=md-ellipsis> 2. Start the Stack </span> </a> </li> <li class=md-nav__item> <a href=#3-access-services class=md-nav__link> <span class=md-ellipsis> 3. Access Services </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#helper-scripts class=md-nav__link> <span class=md-ellipsis> Helper Scripts </span> </a> <nav class=md-nav aria-label="Helper Scripts"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#start-monitoring-stack class=md-nav__link> <span class=md-ellipsis> Start Monitoring Stack </span> </a> </li> <li class=md-nav__item> <a href=#generate-load class=md-nav__link> <span class=md-ellipsis> Generate Load </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#performance-testing-workflow class=md-nav__link> <span class=md-ellipsis> Performance Testing Workflow </span> </a> <nav class=md-nav aria-label="Performance Testing Workflow"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-establish-baseline class=md-nav__link> <span class=md-ellipsis> 1. Establish Baseline </span> </a> </li> <li class=md-nav__item> <a href=#2-run-load-tests class=md-nav__link> <span class=md-ellipsis> 2. Run Load Tests </span> </a> </li> <li class=md-nav__item> <a href=#3-test-configuration-changes class=md-nav__link> <span class=md-ellipsis> 3. Test Configuration Changes </span> </a> </li> <li class=md-nav__item> <a href=#4-compare-results class=md-nav__link> <span class=md-ellipsis> 4. Compare Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#key-metrics-to-monitor class=md-nav__link> <span class=md-ellipsis> Key Metrics to Monitor </span> </a> <nav class=md-nav aria-label="Key Metrics to Monitor"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gc-performance class=md-nav__link> <span class=md-ellipsis> GC Performance </span> </a> </li> <li class=md-nav__item> <a href=#memory-metrics class=md-nav__link> <span class=md-ellipsis> Memory Metrics </span> </a> </li> <li class=md-nav__item> <a href=#application-performance class=md-nav__link> <span class=md-ellipsis> Application Performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#prometheus-queries class=md-nav__link> <span class=md-ellipsis> Prometheus Queries </span> </a> <nav class=md-nav aria-label="Prometheus Queries"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#gc-performance_1 class=md-nav__link> <span class=md-ellipsis> GC Performance </span> </a> </li> <li class=md-nav__item> <a href=#application-performance_1 class=md-nav__link> <span class=md-ellipsis> Application Performance </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#grafana-dashboard class=md-nav__link> <span class=md-ellipsis> Grafana Dashboard </span> </a> <nav class=md-nav aria-label="Grafana Dashboard"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manual-import class=md-nav__link> <span class=md-ellipsis> Manual Import </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration-testing class=md-nav__link> <span class=md-ellipsis> Configuration Testing </span> </a> <nav class=md-nav aria-label="Configuration Testing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#default-configuration class=md-nav__link> <span class=md-ellipsis> Default Configuration </span> </a> </li> <li class=md-nav__item> <a href=#testing-gogc class=md-nav__link> <span class=md-ellipsis> Testing GOGC </span> </a> </li> <li class=md-nav__item> <a href=#testing-different-memory_ratio-values class=md-nav__link> <span class=md-ellipsis> Testing Different MEMORY_RATIO Values </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cannot-access-services class=md-nav__link> <span class=md-ellipsis> Cannot Access Services </span> </a> </li> <li class=md-nav__item> <a href=#no-metrics-showing-in-grafana class=md-nav__link> <span class=md-ellipsis> No Metrics Showing in Grafana </span> </a> </li> <li class=md-nav__item> <a href=#container-wont-start class=md-nav__link> <span class=md-ellipsis> Container Won't Start </span> </a> </li> <li class=md-nav__item> <a href=#media-directory-mount-error class=md-nav__link> <span class=md-ellipsis> Media Directory Mount Error </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#benchmark-results class=md-nav__link> <span class=md-ellipsis> Benchmark Results </span> </a> <nav class=md-nav aria-label="Benchmark Results"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#before-optimization-manual-gc class=md-nav__link> <span class=md-ellipsis> Before Optimization (Manual GC) </span> </a> </li> <li class=md-nav__item> <a href=#after-optimization-memory_ratio075 class=md-nav__link> <span class=md-ellipsis> After Optimization (MEMORY_RATIO=0.75) </span> </a> </li> <li class=md-nav__item> <a href=#configuration-comparison class=md-nav__link> <span class=md-ellipsis> Configuration Comparison </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#data-persistence class=md-nav__link> <span class=md-ellipsis> Data Persistence </span> </a> </li> <li class=md-nav__item> <a href=#production-notes class=md-nav__link> <span class=md-ellipsis> Production Notes </span> </a> </li> <li class=md-nav__item> <a href=#see-also class=md-nav__link> <span class=md-ellipsis> See Also </span> </a> </li> <li class=md-nav__item> <a href=#additional-resources class=md-nav__link> <span class=md-ellipsis> Additional Resources </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=development-monitoring-stack>Development Monitoring Stack</h1> <p>This guide covers the monitoring stack for local development and performance testing using Docker Compose, Prometheus, and Grafana.</p> <h2 id=overview>Overview</h2> <p>The <code>hack/</code> directory contains a complete monitoring stack that includes:</p> <ul> <li><strong>Media Viewer</strong> - Main application with metrics enabled</li> <li><strong>Prometheus</strong> - Metrics collection and storage</li> <li><strong>Grafana</strong> - Visualization and dashboards</li> </ul> <p>This stack is pre-configured with:</p> <ul> <li>Automatic dashboard provisioning</li> <li>Optimized GC settings for testing</li> <li>Cross-platform support (Linux, macOS, Windows)</li> <li>Network accessibility for testing from multiple devices</li> </ul> <h2 id=quick-start>Quick Start</h2> <h3 id=1-configure-media-directory>1. Configure Media Directory</h3> <p>Edit <code>hack/docker-compose.yml</code> to set your media directory path:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=w>    </span><span class=c1># Windows</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">C:\Users\YourName\Videos\media-viewer:/media</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=w>    </span><span class=c1># Linux</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/home/yourname/media-viewer:/media</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=w>    </span><span class=c1># macOS</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/Users/yourname/media-viewer:/media</span>
</code></pre></div> <h3 id=2-start-the-stack>2. Start the Stack</h3> <p><strong>Linux/macOS:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nb>cd</span><span class=w> </span>hack
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>./start-monitoring.sh
</code></pre></div> <p><strong>Windows PowerShell:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=nb>cd </span><span class=n>hack</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=p>.\</span><span class=nb>start-monitoring</span><span class=p>.</span><span class=n>ps1</span>
</code></pre></div> <p><strong>Or manually:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nb>cd</span><span class=w> </span>hack
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>docker-compose<span class=w> </span>up<span class=w> </span>-d
</code></pre></div> <h3 id=3-access-services>3. Access Services</h3> <p>Once running, access the services at:</p> <ul> <li><strong>Media Viewer</strong>: http://localhost:8081</li> <li><strong>Prometheus</strong>: http://localhost:9091</li> <li><strong>Grafana</strong>: http://localhost:3001 (admin/admin)</li> </ul> <p><strong>Note:</strong> These use different host ports than the standard setup to avoid conflicts. The main application is on port 8081 (instead of 8080), Prometheus on 9091 (instead of 9090), and Grafana on 3001 (instead of 3000).</p> <p><strong>Network Access:</strong> If you cannot access via <code>localhost</code>, use your machine's IP address. Find it with:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># Windows</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>ipconfig
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=c1># Linux/macOS</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>ip<span class=w> </span>addr<span class=w> </span>show<span class=w>  </span><span class=c1># or ifconfig</span>
</code></pre></div> <p>Then access: <code>http://192.168.1.100:8081</code> (use your actual IP)</p> <p>For detailed network troubleshooting, see <code>hack/NETWORK-ACCESS.md</code>.</p> <h2 id=helper-scripts>Helper Scripts</h2> <h3 id=start-monitoring-stack>Start Monitoring Stack</h3> <p>Automatically starts Docker Compose and checks service health:</p> <p><strong>Linux/macOS:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=nb>cd</span><span class=w> </span>hack
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>./start-monitoring.sh
</code></pre></div> <p><strong>Windows PowerShell:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=nb>cd </span><span class=n>hack</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=p>.\</span><span class=nb>start-monitoring</span><span class=p>.</span><span class=n>ps1</span>
</code></pre></div> <h3 id=generate-load>Generate Load</h3> <p>Generate realistic load for performance testing (runs for 5 minutes by default):</p> <p><strong>Linux/macOS:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Default - hits localhost:8081</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>./generate-load.sh
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=c1># Custom URL</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=nv>BASE_URL</span><span class=o>=</span>http://192.168.1.100:8081<span class=w> </span>./generate-load.sh
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=c1># Custom duration (10 minutes)</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=nv>DURATION</span><span class=o>=</span><span class=m>600</span><span class=w> </span>./generate-load.sh
</code></pre></div> <p><strong>Windows PowerShell:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=c># Default</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=p>.\</span><span class=n>generate-load</span><span class=p>.</span><span class=n>ps1</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=c># Custom URL</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=p>.\</span><span class=n>generate-load</span><span class=p>.</span><span class=n>ps1</span> <span class=n>-BaseUrl</span> <span class=s2>&quot;http://192.168.1.100:8081&quot;</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=c># Custom duration (10 minutes)</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=p>.\</span><span class=n>generate-load</span><span class=p>.</span><span class=n>ps1</span> <span class=n>-Duration</span> <span class=n>600</span>
</code></pre></div> <p><strong>What it does:</strong></p> <ul> <li>Hits public health check endpoints (<code>/readyz</code>, <code>/healthz</code>)</li> <li>Generates memory allocation load</li> <li>No authentication required</li> <li>Safe for continuous testing</li> </ul> <h2 id=performance-testing-workflow>Performance Testing Workflow</h2> <h3 id=1-establish-baseline>1. Establish Baseline</h3> <p>Start with the default configuration:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=nb>cd</span><span class=w> </span>hack
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>docker-compose<span class=w> </span>up<span class=w> </span>-d
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=c1># Wait 5-10 minutes for metrics to stabilize</span>
</code></pre></div> <p>Record baseline metrics in Grafana:</p> <ul> <li>GC CPU Fraction: *<strong>*_</strong>%**</li> <li>GC Frequency: *<strong>*_**</strong> GCs/min</li> <li>P95 Thumbnail Time: *<strong>*_**</strong> ms</li> <li>Memory Usage: *<strong>*_</strong>%**</li> </ul> <h3 id=2-run-load-tests>2. Run Load Tests</h3> <p>Generate load to stress test the application:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Linux/macOS</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>./generate-load.sh
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1># Windows</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>.<span class=se>\g</span>enerate-load.ps1
</code></pre></div> <h3 id=3-test-configuration-changes>3. Test Configuration Changes</h3> <p>Edit <code>docker-compose.yml</code> to test different settings:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a><span class=w>    </span><span class=c1># Test MEMORY_RATIO</span>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MEMORY_RATIO=0.70</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=w>    </span><span class=c1># Or test GOGC</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GOGC=150</span>
</code></pre></div> <p>Restart and monitor:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>docker-compose<span class=w> </span>restart<span class=w> </span>media-viewer
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=c1># Wait 5-10 minutes for steady state</span>
</code></pre></div> <h3 id=4-compare-results>4. Compare Results</h3> <p>Use Grafana's time range selector to overlay different periods and compare:</p> <ul> <li>GC CPU overhead changes</li> <li>GC frequency changes</li> <li>Memory usage patterns</li> <li>Throughput improvements</li> </ul> <h2 id=key-metrics-to-monitor>Key Metrics to Monitor</h2> <h3 id=gc-performance>GC Performance</h3> <table> <thead> <tr> <th>Metric</th> <th>Target</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><code>media_viewer_go_gc_cpu_fraction</code></td> <td>&lt; 3%</td> <td>Percentage of CPU time spent in GC</td> </tr> <tr> <td>GC Frequency</td> <td>&lt; 10 GCs/min</td> <td>How often garbage collection runs</td> </tr> <tr> <td>GC Pause Duration</td> <td>&lt; 5ms (individual)</td> <td>Stop-the-world pause time</td> </tr> <tr> <td>GC Pause Budget</td> <td>&lt; 10ms/sec (total)</td> <td>Total pause time per second</td> </tr> </tbody> </table> <h3 id=memory-metrics>Memory Metrics</h3> <table> <thead> <tr> <th>Metric</th> <th>Target</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td><code>media_viewer_memory_usage_ratio</code></td> <td>&lt; 85%</td> <td>Memory usage vs configured limit</td> </tr> <tr> <td>Allocation Rate</td> <td>varies</td> <td>MB/sec being allocated</td> </tr> <tr> <td>Heap Size</td> <td>varies</td> <td>Current Go heap size</td> </tr> </tbody> </table> <h3 id=application-performance>Application Performance</h3> <table> <thead> <tr> <th>Metric</th> <th>Target</th> <th>Interpretation</th> </tr> </thead> <tbody> <tr> <td>P95 Thumbnail Time</td> <td>&lt; 500ms</td> <td>95th percentile generation time</td> </tr> <tr> <td>P95 API Latency</td> <td>&lt; 100ms</td> <td>95th percentile request latency</td> </tr> <tr> <td>Cache Hit Rate</td> <td>&gt; 80%</td> <td>Thumbnail cache efficiency</td> </tr> <tr> <td>Indexing Throughput</td> <td>varies</td> <td>Files processed per second</td> </tr> </tbody> </table> <h2 id=prometheus-queries>Prometheus Queries</h2> <p>Access Prometheus at http://localhost:9091/graph and run these queries:</p> <h3 id=gc-performance_1>GC Performance</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># GC CPU overhead (percentage)</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=nv>media_viewer_go_gc_cpu_fraction</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1># GC frequency (GCs per minute)</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_go_gc_runs_total</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>60</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=c1># GC pause budget (ms per second)</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_go_gc_pause_total_seconds</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>1000</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=c1># Memory pressure (% of GOMEMLIMIT)</span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=nv>media_viewer_go_memalloc_bytes</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=nv>media_viewer_go_memlimit_bytes</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=mi>100</span>
</code></pre></div> <h3 id=application-performance_1>Application Performance</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># P95 thumbnail generation time</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=kr>histogram_quantile</span><span class=o>(</span><span class=mf>0.95</span><span class=p>,</span>
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=w>  </span><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_thumbnail_generation_duration_seconds_bucket</span><span class=p>{</span><span class=nl>type</span><span class=o>=</span><span class=p>&quot;</span><span class=s>image</span><span class=p>&quot;}[</span><span class=s>5m</span><span class=p>]</span><span class=o>))</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=c1># P95 API latency</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a><span class=kr>histogram_quantile</span><span class=o>(</span><span class=mf>0.95</span><span class=p>,</span>
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=w>  </span><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_http_request_duration_seconds_bucket</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>))</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a><span class=c1># Request rate</span>
<a id=__codelineno-14-10 name=__codelineno-14-10 href=#__codelineno-14-10></a><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_http_requests_total</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span>
<a id=__codelineno-14-11 name=__codelineno-14-11 href=#__codelineno-14-11></a>
<a id=__codelineno-14-12 name=__codelineno-14-12 href=#__codelineno-14-12></a><span class=c1># Cache hit rate</span>
<a id=__codelineno-14-13 name=__codelineno-14-13 href=#__codelineno-14-13></a><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_thumbnail_cache_hits_total</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span>
<a id=__codelineno-14-14 name=__codelineno-14-14 href=#__codelineno-14-14></a><span class=w>  </span><span class=o>/</span>
<a id=__codelineno-14-15 name=__codelineno-14-15 href=#__codelineno-14-15></a><span class=o>(</span><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_thumbnail_cache_hits_total</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>)</span>
<a id=__codelineno-14-16 name=__codelineno-14-16 href=#__codelineno-14-16></a><span class=w>  </span><span class=o>+</span><span class=w> </span><span class=kr>rate</span><span class=o>(</span><span class=nv>media_viewer_thumbnail_cache_misses_total</span><span class=p>[</span><span class=s>5m</span><span class=p>]</span><span class=o>))</span>
</code></pre></div> <h2 id=grafana-dashboard>Grafana Dashboard</h2> <p>The stack includes a pre-built dashboard with panels for:</p> <ul> <li><strong>HTTP Performance</strong>: Request rates, latencies, error rates</li> <li><strong>Garbage Collection</strong>: CPU overhead, frequency, pause times</li> <li><strong>Memory Usage</strong>: Heap size, allocation rate, pressure</li> <li><strong>Indexing</strong>: Throughput, batch performance, errors</li> <li><strong>Thumbnails</strong>: Generation time, cache efficiency, phase timing</li> <li><strong>Database</strong>: Query performance, transaction rates</li> </ul> <p>The dashboard is automatically loaded on startup.</p> <h3 id=manual-import>Manual Import</h3> <p>If the dashboard doesn't load automatically:</p> <ol> <li>Go to Dashboards  Import in Grafana</li> <li>Upload <code>hack/grafana/dashboard.json</code></li> </ol> <h2 id=configuration-testing>Configuration Testing</h2> <h3 id=default-configuration>Default Configuration</h3> <p>The stack starts with optimized production settings:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MEMORY_LIMIT=2147483648</span><span class=w> </span><span class=c1># 2 GiB</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MEMORY_RATIO=0.75</span><span class=w> </span><span class=c1># Recommended for production</span>
</code></pre></div> <p><strong>Expected results:</strong></p> <ul> <li>GC CPU overhead: ~0.16%</li> <li>GC frequency: 0.2/s idle, 6/s under load</li> <li>Adaptive behavior based on workload</li> </ul> <h3 id=testing-gogc>Testing GOGC</h3> <p>Test fixed GC targeting instead of memory ratio:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GOGC=150</span>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>    </span><span class=c1># Comment out MEMORY_RATIO when using GOGC</span>
</code></pre></div> <p><strong>Expected results:</strong></p> <ul> <li>GC CPU overhead: ~0.15%</li> <li>GC frequency: ~4.5/s (constant)</li> <li>Predictable behavior regardless of load</li> </ul> <h3 id=testing-different-memory_ratio-values>Testing Different MEMORY_RATIO Values</h3> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>    </span><span class=c1># More memory for Go heap (more caching)</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MEMORY_RATIO=0.80</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a><span class=w>    </span><span class=c1># Less memory for Go heap (more for FFmpeg/CGO)</span>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">MEMORY_RATIO=0.70</span>
</code></pre></div> <h2 id=troubleshooting>Troubleshooting</h2> <h3 id=cannot-access-services>Cannot Access Services</h3> <p><strong>Symptom:</strong> Cannot connect to http://localhost:8081</p> <p><strong>Solutions:</strong></p> <ol> <li> <p><strong>Check containers are running:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a>docker-compose<span class=w> </span>ps
</code></pre></div> <p>All should show "Up" status.</p> </li> <li> <p><strong>Check port conflicts:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=c1># Windows</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a>netstat<span class=w> </span>-ano<span class=w> </span><span class=p>|</span><span class=w> </span>findstr<span class=w> </span><span class=s2>&quot;8081&quot;</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=c1># Linux/macOS</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a>lsof<span class=w> </span>-i<span class=w> </span>:8081
</code></pre></div> </li> <li> <p><strong>Use host IP instead of localhost:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=c1># Find your IP</span>
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>ipconfig<span class=w>  </span><span class=c1># Windows</span>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a>ip<span class=w> </span>addr<span class=w>   </span><span class=c1># Linux</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=c1># Access via IP</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>http://192.168.1.100:8081
</code></pre></div> </li> <li> <p><strong>Check firewall (Windows):</strong></p> <p>Ports may need to be allowed through Windows Firewall if accessing from another machine.</p> </li> </ol> <p>See <code>hack/NETWORK-ACCESS.md</code> for detailed troubleshooting.</p> <h3 id=no-metrics-showing-in-grafana>No Metrics Showing in Grafana</h3> <p><strong>Check Prometheus scraping:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=c1># Check targets</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>curl<span class=w> </span>http://localhost:9091/api/v1/targets
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=c1># Check metrics endpoint</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a>curl<span class=w> </span>http://localhost:8081/metrics<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>media_viewer_go_gc
</code></pre></div> <p><strong>Check Prometheus target status:</strong></p> <p>Visit http://localhost:9091/targets - should show <code>media-viewer (1/1 up)</code></p> <h3 id=container-wont-start>Container Won't Start</h3> <p><strong>Check logs:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a>docker-compose<span class=w> </span>logs<span class=w> </span>media-viewer
</code></pre></div> <p><strong>Rebuild if needed:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a>docker-compose<span class=w> </span>build<span class=w> </span>--no-cache<span class=w> </span>media-viewer
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a>docker-compose<span class=w> </span>up<span class=w> </span>-d
</code></pre></div> <h3 id=media-directory-mount-error>Media Directory Mount Error</h3> <p><strong>Windows:</strong></p> <ol> <li>Ensure directory exists: <code>Test-Path "D:\path\to\media"</code></li> <li>Check Docker Desktop  Settings  Resources  File Sharing</li> <li>Ensure drive is shared and restart Docker Desktop</li> </ol> <p><strong>Linux/macOS:</strong></p> <ol> <li>Check permissions: <code>ls -la /path/to/media</code></li> <li>Ensure directory exists: <code>mkdir -p /path/to/media</code></li> </ol> <h2 id=benchmark-results>Benchmark Results</h2> <p>Based on real-world testing with 3,106 thumbnail generation:</p> <h3 id=before-optimization-manual-gc>Before Optimization (Manual GC)</h3> <table> <thead> <tr> <th>Metric</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>GC CPU Overhead</td> <td>1.88%</td> </tr> <tr> <td>GC Frequency (idle)</td> <td>31/sec</td> </tr> <tr> <td>GC Frequency (load)</td> <td>31/sec</td> </tr> <tr> <td>Memory Usage</td> <td>502 MB</td> </tr> </tbody> </table> <h3 id=after-optimization-memory_ratio075>After Optimization (MEMORY_RATIO=0.75)</h3> <table> <thead> <tr> <th>Metric</th> <th>Value</th> <th>Improvement</th> </tr> </thead> <tbody> <tr> <td>GC CPU Overhead</td> <td>0.16%</td> <td> 91%</td> </tr> <tr> <td>GC Frequency (idle)</td> <td>0.2/sec</td> <td> 99%</td> </tr> <tr> <td>GC Frequency (load)</td> <td>6/sec</td> <td> 80%</td> </tr> <tr> <td>Memory Usage</td> <td>534 MB</td> <td>+6%</td> </tr> </tbody> </table> <h3 id=configuration-comparison>Configuration Comparison</h3> <table> <thead> <tr> <th>Configuration</th> <th>GC CPU %</th> <th>Idle GC/s</th> <th>Load GC/s</th> <th>Behavior</th> </tr> </thead> <tbody> <tr> <td>Original (Manual GC)</td> <td>1.88%</td> <td>31</td> <td>31</td> <td>Fixed</td> </tr> <tr> <td>GOGC=150</td> <td>0.15%</td> <td>4.5</td> <td>4.5</td> <td>Fixed</td> </tr> <tr> <td><strong>MEMORY_RATIO=0.75</strong></td> <td><strong>0.16%</strong></td> <td><strong>0.2</strong></td> <td><strong>6</strong></td> <td><strong>Adaptive</strong> </td> </tr> </tbody> </table> <h2 id=data-persistence>Data Persistence</h2> <p>All data is persisted in Docker volumes:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=c1># List volumes</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>docker<span class=w> </span>volume<span class=w> </span>ls<span class=w> </span><span class=p>|</span><span class=w> </span>grep<span class=w> </span>hack
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=c1># Backup Grafana dashboards</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>docker<span class=w> </span>cp<span class=w> </span>hack-grafana-1:/var/lib/grafana/dashboards<span class=w> </span>./backup/
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=c1># Clean up everything (WARNING: deletes all data)</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a>docker-compose<span class=w> </span>down<span class=w> </span>-v
</code></pre></div> <h2 id=production-notes>Production Notes</h2> <p>The monitoring stack in <code>hack/</code> is designed for development and testing. For production deployment:</p> <ol> <li> <p><strong>Secure Grafana:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">GF_SECURITY_ADMIN_PASSWORD=&lt;strong-password&gt;</span>
</code></pre></div> </li> <li> <p><strong>Increase Prometheus retention:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>command</span><span class=p>:</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&#39;--storage.tsdb.retention.time=30d&#39;</span>
</code></pre></div> </li> <li> <p><strong>Add resource limits:</strong> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=nt>deploy</span><span class=p>:</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>    </span><span class=nt>resources</span><span class=p>:</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=w>        </span><span class=nt>limits</span><span class=p>:</span>
<a id=__codelineno-27-4 name=__codelineno-27-4 href=#__codelineno-27-4></a><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1G</span>
<a id=__codelineno-27-5 name=__codelineno-27-5 href=#__codelineno-27-5></a><span class=w>            </span><span class=nt>cpus</span><span class=p>:</span><span class=w> </span><span class=s>&#39;0.5&#39;</span>
</code></pre></div></p> </li> </ol> <p>See the <a href=../../admin/metrics/ >Metrics &amp; Monitoring</a> documentation for production deployment guidance.</p> <h2 id=see-also>See Also</h2> <ul> <li><a href=profiling.md>Profiling Guide</a> - CPU, memory, and database profiling techniques</li> <li><a href=../../admin/memory-tuning/ >Memory &amp; GC Tuning</a> - Detailed tuning guide with benchmarks</li> <li><a href=../../admin/metrics/ >Metrics Reference</a> - Complete metrics documentation</li> <li><a href=../architecture/ >Architecture Overview</a> - System architecture and design</li> <li><a href=../testing/ >Testing Guide</a> - Backend testing practices</li> </ul> <h2 id=additional-resources>Additional Resources</h2> <p>The <code>hack/</code> directory contains additional documentation:</p> <ul> <li><strong>ARCHITECTURE.md</strong> - Port mappings and network architecture</li> <li><strong>NETWORK-ACCESS.md</strong> - Network troubleshooting guide</li> <li><strong>GC-MONITORING.md</strong> - Historical GC tuning guide (see <a href=../../admin/memory-tuning/ >Memory Tuning</a> for current docs)</li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/djryanj/media-viewer target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> </body> </html>